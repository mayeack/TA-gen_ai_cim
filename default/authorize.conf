#
# authorize.conf - Role definitions
# TA-gen_ai_cim
#
# Defines the ai_reviewers role for analysts who can edit review findings.
# Users with this role can read/write to the KV store collection.
#
# Compatible with: Splunk Enterprise 9.0+, Splunk Cloud
#

###############################################################################
# AI REVIEWERS ROLE
# Grants ability to create and update review findings
###############################################################################

[role_ai_reviewers]
# Import capabilities from default user role
importRoles = user

# Search capabilities needed for review workflow
srchIndexesAllowed = gen_ai_cim;gen_ai_log;ai_log2;main
srchIndexesDefault = gen_ai_log

# Time range limits (adjust as needed for your environment)
srchTimeWin = -1
srchDiskQuota = 500
srchJobsQuota = 10

# KV store write capability is granted via metadata permissions
# Additional capabilities for REST API access
# Note: list_storage_passwords only if needed for custom integrations

###############################################################################
# ADMIN ROLE EXTENSION
# Adds MLTK AI command capability for AI-powered summaries
###############################################################################

[role_admin]
# Enable MLTK AI Toolkit capabilities for ServiceNow case AI summaries
# Required for the aicase command to generate AI-powered summaries
apply_ai_commander_command = enabled
list_ai_commander_config = enabled
# Allow running ML commands in dashboards without risky command warnings
run_risky_commands = enabled

###############################################################################
# ML FEEDBACK LOOP ROLE
# Role for users who need to view ML dashboards with fit/apply commands
###############################################################################

[role_ml_power_user]
importRoles = power
# Allow running ML commands in dashboards without risky command warnings
run_risky_commands = enabled
srchIndexesAllowed = gen_ai_cim;gen_ai_log;ai_log2;main
srchIndexesDefault = gen_ai_log
