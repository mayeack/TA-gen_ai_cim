<dashboard version="1.1" theme="light" script="servicenow_case.js" hideEdit="true" hideExport="true">
  <label>Opening ServiceNow Case...</label>
  
  <row>
    <panel>
      <html>
        <div id="case_status" style="text-align: center; padding: 50px; font-size: 18px;">
          <div id="loading_message">
            <p>Processing request...</p>
            <p style="color: #666; font-size: 14px;">Creating or finding ServiceNow AI Case</p>
          </div>
          <div id="error_message" style="display: none; color: #dc3545;">
            <p>Error</p>
            <p id="error_text" style="font-size: 14px;"></p>
          </div>
          <div id="success_message" style="display: none; color: #28a745;">
            <p>Redirecting to ServiceNow...</p>
            <p style="font-size: 14px;"><a id="manual_link" href="#" target="_blank">Click here if not redirected</a></p>
          </div>
        </div>
      </html>
    </panel>
  </row>
  
  <row>
    <panel>
      <table id="case_results">
        <search id="case_search">
          <query>| makeresults | eval gen_ai.event.id="$event_id$", "gen_ai.service.name"="$service_name$" | aicase | table snow_case_url snow_case_sys_id snow_case_status snow_case_message</query>
          <earliest>-1m</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">none</option>
      </table>
    </panel>
  </row>
</dashboard>
