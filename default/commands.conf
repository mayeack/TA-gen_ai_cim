#
# commands.conf - Custom Search Command Definitions
# TA-gen_ai_cim
#
# Defines custom search commands for ServiceNow AI Case Management integration.
#
# Compatible with: Splunk Enterprise 9.0+, Splunk Cloud
#

###############################################################################
# AICASE - ServiceNow AI Case Management Command
###############################################################################

[aicase]
# Description: Create or lookup ServiceNow AI Case records linked to GenAI events
#
# Usage:
#   | aicase [request_id=<value>] [mode=create|lookup|open]
#
# Parameters:
#   request_id - Optional. Override gen_ai.request.id from event
#   mode       - Optional. create (default), lookup (check only), open (URL only)
#
# Examples:
#   index=gen_ai_log | aicase
#   | makeresults | eval gen_ai.request.id="abc123" | aicase request_id=abc123
#   index=gen_ai_log | aicase mode=lookup
#
# Output Fields:
#   snow_case_url     - URL to ServiceNow AI Case
#   snow_case_sys_id  - ServiceNow sys_id
#   snow_case_number  - Case number
#   snow_case_status  - created, existing, not_found, error
#   snow_case_message - Human-readable status

# Python search command using Splunk SDK
filename = aicase.py

# Streaming command - processes events one at a time
streaming = true

# Command type - streaming (processes each event)
type = streaming

# Use chunked protocol for Python SDK streaming commands
chunked = true

# Enable passauth for REST API access to storage passwords
passauth = splunk-system-user

# Python version - prefer python3
python.version = python3

# Required capabilities for the command
# Note: User must have admin_all_objects OR list_storage_passwords + write to kvstore
# Configured via authorize.conf roles
