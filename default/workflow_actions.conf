#
# workflow_actions.conf - Event Context Menu Actions
# TA-gen_ai_cim
#
# Defines workflow actions that appear in the Event Context menu (right-click
# on events in search results) for AI governance review and ServiceNow integration.
#
# Compatible with: Splunk Enterprise 9.0+, Splunk Cloud
#

###############################################################################
# OPEN AI REVIEW
# Shows for all events with event_id - opens review page
# If new: creates record and assigns to user
# If existing: opens the existing review for viewing/editing
# Prefix "1_" ensures this appears first in the action list
###############################################################################

[1_open_ai_review]
display_location = both
label = ðŸ“‹ Open AI Review
link.method = get
link.target = blank
link.uri = /app/TA-gen_ai_cim/review_landing?event_id=$!gen_ai.event.id$
type = link
fields = gen_ai.event.id

###############################################################################
# OPEN CASE IN SERVICENOW
# Creates or opens ServiceNow AI Case for the selected event
###############################################################################

[open_case_in_servicenow]
# Display name in the Event Context menu
display_location = event_menu
label = ðŸš¨ Open Case in ServiceNow

# Priority controls order in menu (lower = appears higher in the list)
# Note: "Open AI Review" appears first, so this should come second
priority = 1

# Field conditions - only show when gen_ai.event.id is present
fields = gen_ai.event.id, gen_ai.service.name

# Type: link opens a URL directly
type = link

# Link to the redirect page that handles case creation and auto-redirects to ServiceNow
link.uri = /app/TA-gen_ai_cim/servicenow_case?event_id=$gen_ai.event.id$&service_name=$gen_ai.service.name$

# Open in new window
link.target = blank

# Event types this action applies to (all events with the required fields)
eventtypes = *
