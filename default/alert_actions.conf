#
# alert_actions.conf - Alert Action Definitions
# TA-gen_ai_cim
#
# Defines alert actions for ServiceNow AI Case Management integration.
# This provides a fallback workflow for Splunk Cloud environments where
# custom search commands may be restricted.
#
# Compatible with: Splunk Enterprise 9.0+, Splunk Cloud
#

###############################################################################
# CREATE SERVICENOW AI CASE
# Alert action to create a ServiceNow AI Case from triggered alerts
###############################################################################

[create_snow_aicase]
# Display name in the UI
label = Create ServiceNow AI Case
description = Creates an AI Case in ServiceNow AI Case Management for the triggered event

# Icon to display (uses Splunk's built-in icons)
icon_path = servicenow.png

# Alert action is available for both alerts and ad-hoc actions
is_custom = 1

# Payload format
payload_format = json

# Allow this action on scheduled alerts
forceCsvResults = auto

# The script that runs when the action is triggered
alert.execute.cmd = create_snow_case.py

# Command-line arguments passed to the script
# $result.gen_ai.request.id$ is the field from the triggering event
alert.execute.cmd.arg.request_id = $result.gen_ai.request.id$

# Track whether action was successful
track_alert = 1

# Maximum number of concurrent executions
maxresults = 100
maxtime = 5m

# Parameters configurable in the alert action UI
param._cam = {"supports_adhoc":true,"supports_savedreport":true}

param.request_id = <string>
param.request_id.description = GenAI Request ID (gen_ai.request.id)

param.case_description = <string>
param.case_description.description = Optional: Additional description for the case
