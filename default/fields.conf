#
# fields.conf - Field definitions for GenAI CIM
# TA-gen_ai_cim
#
# Declares all normalized fields in the gen_ai.* namespace
# with appropriate data types and multi-value settings
#

###############################################################################
# CORE OPERATION / MODEL IDENTITY
###############################################################################

[gen_ai.operation.name]
INDEXED = false
TOKENIZED = true

[gen_ai.provider.name]
INDEXED = false
TOKENIZED = true

[gen_ai.request.model]
INDEXED = false
TOKENIZED = true

[gen_ai.response.model]
INDEXED = false
TOKENIZED = true

[gen_ai.response.id]
INDEXED = false
TOKENIZED = true

[gen_ai.conversation.id]
INDEXED = false
TOKENIZED = true

[gen_ai.deployment.id]
INDEXED = false
TOKENIZED = true

[gen_ai.request.id]
INDEXED = false
TOKENIZED = true

[gen_ai.session.id]
INDEXED = false
TOKENIZED = true

[gen_ai.event.id]
INDEXED = false
TOKENIZED = true

[trace_id]
INDEXED = false
TOKENIZED = true

###############################################################################
# INPUT/OUTPUT PAYLOAD
###############################################################################

[gen_ai.input.messages]
INDEXED = false
TOKENIZED = false

[gen_ai.output.messages]
INDEXED = false
TOKENIZED = false

[gen_ai.input.messages_raw]
INDEXED = false
TOKENIZED = false

[gen_ai.output.messages_raw]
INDEXED = false
TOKENIZED = false

[gen_ai.system_instructions]
INDEXED = false
TOKENIZED = false

[gen_ai.tool.definitions]
INDEXED = false
TOKENIZED = false

[gen_ai.output.type]
INDEXED = false
TOKENIZED = true

###############################################################################
# REQUEST PARAMETERS
###############################################################################

[gen_ai.token.type]
INDEXED = false
TOKENIZED = true

[gen_ai.request.max_tokens]
INDEXED = false
TOKENIZED = false

[gen_ai.request.temperature]
INDEXED = false
TOKENIZED = false

[gen_ai.request.top_p]
INDEXED = false
TOKENIZED = false

[gen_ai.request.frequency_penalty]
INDEXED = false
TOKENIZED = false

[gen_ai.request.presence_penalty]
INDEXED = false
TOKENIZED = false

[gen_ai.request.stop_sequences]
INDEXED = false
TOKENIZED = true
# Multi-value field

[gen_ai.response.finish_reasons]
INDEXED = false
TOKENIZED = true
# Multi-value field

[gen_ai.request.choice.count]
INDEXED = false
TOKENIZED = false

[gen_ai.request.seed]
INDEXED = false
TOKENIZED = false

###############################################################################
# USAGE, PERFORMANCE, AND COST
###############################################################################

[gen_ai.usage.input_tokens]
INDEXED = false
TOKENIZED = false

[gen_ai.usage.output_tokens]
INDEXED = false
TOKENIZED = false

[gen_ai.usage.total_tokens]
INDEXED = false
TOKENIZED = false

[gen_ai.client.operation.duration]
INDEXED = false
TOKENIZED = false

[gen_ai.server.request.duration]
INDEXED = false
TOKENIZED = false

[gen_ai.server.time_per_output_token]
INDEXED = false
TOKENIZED = false

[gen_ai.server.time_to_first_token]
INDEXED = false
TOKENIZED = false

[gen_ai.cost.total]
INDEXED = false
TOKENIZED = false

[gen_ai.cost.input]
INDEXED = false
TOKENIZED = false

[gen_ai.cost.output]
INDEXED = false
TOKENIZED = false

###############################################################################
# SAFETY, GUARDRAILS, AND POLICY
###############################################################################

[gen_ai.safety.violated]
INDEXED = false
TOKENIZED = true

[gen_ai.safety.categories]
INDEXED = false
TOKENIZED = true
# Multi-value field

[gen_ai.safety.score]
INDEXED = false
TOKENIZED = false

[gen_ai.guardrail.triggered]
INDEXED = false
TOKENIZED = true

[gen_ai.guardrail.ids]
INDEXED = false
TOKENIZED = true
# Multi-value field

[gen_ai.pii.detected]
INDEXED = false
TOKENIZED = true

[gen_ai.pii.types]
INDEXED = false
TOKENIZED = true
# Multi-value field

[gen_ai.policy.blocked]
INDEXED = false
TOKENIZED = true

###############################################################################
# EVALUATION / TEVV (QUALITY, RISK, DRIFT)
###############################################################################

[gen_ai.evaluation.name]
INDEXED = false
TOKENIZED = true

[gen_ai.evaluation.score.value]
INDEXED = false
TOKENIZED = false

[gen_ai.evaluation.score.label]
INDEXED = false
TOKENIZED = true

[gen_ai.evaluation.explanation]
INDEXED = false
TOKENIZED = false

[gen_ai.drift.metric.name]
INDEXED = false
TOKENIZED = true

[gen_ai.drift.metric.value]
INDEXED = false
TOKENIZED = false

[gen_ai.drift.status]
INDEXED = false
TOKENIZED = true

###############################################################################
# ERROR AND INFRA FIELDS
###############################################################################

[error.type]
INDEXED = false
TOKENIZED = true

[error.message]
INDEXED = false
TOKENIZED = false

[gen_ai.status]
INDEXED = false
TOKENIZED = true

[server.address]
INDEXED = false
TOKENIZED = true

[server.port]
INDEXED = false
TOKENIZED = false

###############################################################################
# ACTOR / APPLICATION CONTEXT
###############################################################################

[enduser.id]
INDEXED = false
TOKENIZED = true

[service.name]
INDEXED = false
TOKENIZED = true

[client.address]
INDEXED = false
TOKENIZED = true

[gen_ai.user.id]
INDEXED = false
TOKENIZED = true

[gen_ai.app.name]
INDEXED = false
TOKENIZED = true

###############################################################################
# MLTK-ENHANCED FIELDS (Added by ML scoring)
###############################################################################

[gen_ai.pii.risk_score]
INDEXED = false
TOKENIZED = false
# Probability score 0-1 from MLTK PII detection model

[gen_ai.pii.ml_detected]
INDEXED = false
TOKENIZED = true
# Boolean flag from MLTK PII detection model

[gen_ai.prompt_injection.risk_score]
INDEXED = false
TOKENIZED = false
# Probability score 0-1 from MLTK prompt injection model

[gen_ai.prompt_injection.ml_detected]
INDEXED = false
TOKENIZED = true
# Boolean flag from MLTK prompt injection model

[gen_ai.prompt_injection.technique]
INDEXED = false
TOKENIZED = true
# Detected injection technique (e.g., ignore_instructions, reveal_system, jailbreak)

###############################################################################
# TF-IDF ANOMALY DETECTION FIELDS
###############################################################################

[gen_ai.prompt.anomaly_score]
INDEXED = false
TOKENIZED = false
# Normalized anomaly score from TF-IDF OneClassSVM model for prompts (0-1 scale)
# Higher values indicate more anomalous (closer to 1 = more suspicious)
# Lower values indicate more normal (closer to 0 = typical content)
# Computed via sigmoid normalization: 1 / (1 + exp(decision_function_score))

[gen_ai.prompt.is_anomaly]
INDEXED = false
TOKENIZED = true
# Boolean flag from hybrid anomaly detection (ML + pattern-based)
# "true" if ML anomaly detected OR pattern score exceeds threshold

[gen_ai.prompt.anomaly_source]
INDEXED = false
TOKENIZED = true
# Source of anomaly detection for prompts
# Values: "ml_and_pattern", "ml_only", "pattern_only", "none"
# Helps identify which detection method triggered the anomaly flag

[gen_ai.prompt.pattern_score]
INDEXED = false
TOKENIZED = false
# Pattern-based anomaly score for prompts (pre-ML text analysis)
# Higher scores indicate more suspicious patterns detected
# Scoring: jailbreak=3, injection_markers=3, gibberish=3, roleplay=2, encoding=2, delimiters=1, brackets=1, repeated_chars=1

[gen_ai.response.anomaly_score]
INDEXED = false
TOKENIZED = false
# Normalized anomaly score from TF-IDF OneClassSVM model for responses (0-1 scale)
# Higher values indicate more anomalous (closer to 1 = more suspicious)
# Lower values indicate more normal (closer to 0 = typical content)
# Computed via sigmoid normalization: 1 / (1 + exp(decision_function_score))

[gen_ai.response.is_anomaly]
INDEXED = false
TOKENIZED = true
# Boolean flag from hybrid anomaly detection (ML + pattern-based)
# "true" if ML anomaly detected OR pattern score exceeds threshold

[gen_ai.response.anomaly_source]
INDEXED = false
TOKENIZED = true
# Source of anomaly detection for responses
# Values: "ml_and_pattern", "ml_only", "pattern_only", "none"
# Helps identify which detection method triggered the anomaly flag

[gen_ai.response.pattern_score]
INDEXED = false
TOKENIZED = false
# Pattern-based anomaly score for responses (pre-ML text analysis)
# Higher scores indicate more suspicious patterns detected
# Scoring: harmful_content=3, jailbreak_confirm=3, system_leak=2

[gen_ai.tfidf.combined_anomaly]
INDEXED = false
TOKENIZED = true
# Combined anomaly classification
# Values: "both", "prompt_only", "response_only", "normal"

[gen_ai.tfidf.risk_level]
INDEXED = false
TOKENIZED = true
# Risk level based on combined anomaly assessment
# Values: "HIGH" (both), "MEDIUM" (prompt_only), "LOW" (response_only), "NONE" (normal)
